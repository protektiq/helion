(()=>{var e={};e.id=666,e.ids=[666],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6305:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>g,tree:()=>d}),r(2814),r(9935),r(5866);var s=r(3191),i=r(8716),n=r(7922),l=r.n(n),o=r(5231),a={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>o[e]);r.d(t,a);let d=["",{children:["reasoning",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2814)),"/home/carlos/helion/web/app/reasoning/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9935)),"/home/carlos/helion/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/carlos/helion/web/app/reasoning/page.tsx"],u="/reasoning/page",p={require:r,loadChunk:()=>Promise.resolve()},g=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/reasoning/page",pathname:"/reasoning",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4485:(e,t,r)=>{Promise.resolve().then(r.bind(r,4040))},7327:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(326);let i={marginBottom:"1rem",color:"#b91c1c"};function n({message:e,onRetry:t,retryLabel:r}){return(0,s.jsxs)("div",{role:"alert",style:i,children:[s.jsx("p",{style:{margin:0},children:e}),"function"==typeof t&&s.jsx("button",{type:"button",onClick:t,"aria-label":r??"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},4040:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(326),i=r(7577),n=r(434),l=r(2809),o=r(7277),a=r(565),d=r(7327);function c(){let[e,t]=(0,i.useState)(!0),[r,c]=(0,i.useState)(""),[u,p]=(0,i.useState)("idle"),[g,m]=(0,i.useState)(null),[h,y]=(0,i.useState)(null),[f,x]=(0,i.useState)(!1),b=(0,i.useCallback)(e=>{t(e.target.checked)},[]),v=(0,i.useCallback)(e=>{c(e.target.value)},[]),_=(0,i.useCallback)(async t=>{if(t.preventDefault(),x(!1),!e){let[e,t]=(0,a.Y)(r);if(null!==t||null===e){y(t??"Failed to parse clusters."),p("error"),m(null);return}p("submitting"),m(null),y(null);try{let t=(0,l.Um)(),r=await t.postReasoning({clusters:e,use_db:!1});m(r),p("success")}catch(e){y((0,l.e$)(e)),p("error")}return}p("submitting"),m(null),y(null);try{let e=(0,l.Um)(),t=await e.postReasoning({clusters:[],use_db:!0});m(t),p("success")}catch(e){y((0,l.e$)(e)),p("error")}},[e,r]),j=(0,i.useCallback)(()=>{null!==g&&((0,o.ds)(g),x(!0))},[g]);return(0,s.jsxs)("main",{style:{padding:"2rem",maxWidth:"48rem",margin:"0 auto"},children:[s.jsx("h1",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Reasoning"}),(0,s.jsxs)("form",{onSubmit:_,style:{marginBottom:"1.5rem"},children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[s.jsx("input",{type:"checkbox",checked:e,onChange:b,"aria-label":"Use current clusters from database","aria-checked":e}),s.jsx("span",{children:"Use current clusters from database"})]}),!e&&(0,s.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[s.jsx("label",{htmlFor:"reasoning-clusters-json",style:{display:"block",marginBottom:"0.25rem"},children:"Paste clusters JSON"}),s.jsx("textarea",{id:"reasoning-clusters-json",value:r,onChange:v,placeholder:"Paste ClustersResponse.clusters JSON or full ClustersResponse object",rows:8,style:{width:"100%",padding:"0.5rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"4px"},"aria-describedby":"reasoning-clusters-hint"}),(0,s.jsxs)("span",{id:"reasoning-clusters-hint",style:{fontSize:"0.75rem",color:"#6b7280"},children:['ClustersResponse with "clusters" array or raw array of clusters (max ',a.g,")."]})]}),s.jsx("button",{type:"submit",disabled:"submitting"===u,"aria-busy":"submitting"===u,"aria-label":"submitting"===u?"Running reasoning":"Run reasoning",children:"submitting"===u?"Running…":"Run reasoning"})]}),"error"===u&&null!==h&&""!==h&&s.jsx(d.Z,{message:h}),"success"===u&&null!==g&&(0,s.jsxs)("div",{children:[s.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Summary"}),s.jsx("p",{style:{marginBottom:"1rem",whiteSpace:"pre-wrap"},children:g.summary||"—"}),s.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Cluster notes"}),(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #e5e7eb"},"aria-label":"Per-cluster notes: vulnerability id, priority, tier, override, reasoning",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[s.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"vulnerability_id"}),s.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"priority"}),s.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"assigned_tier"}),s.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"override_applied"}),s.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"reasoning"})]})}),s.jsx("tbody",{children:g.cluster_notes.map(e=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[s.jsx("td",{style:{padding:"0.5rem 0.75rem",verticalAlign:"top"},children:e.vulnerability_id}),s.jsx("td",{style:{padding:"0.5rem 0.75rem",verticalAlign:"top"},children:e.priority}),s.jsx("td",{style:{padding:"0.5rem 0.75rem",verticalAlign:"top"},children:null!=e.assigned_tier?e.assigned_tier:"—"}),s.jsx("td",{style:{padding:"0.5rem 0.75rem",verticalAlign:"top",color:"#6b7280"},children:e.override_applied??"—"}),s.jsx("td",{style:{padding:"0.5rem 0.75rem",verticalAlign:"top",color:"#374151",whiteSpace:"pre-wrap"},children:e.reasoning})]},e.vulnerability_id))})]}),(0,s.jsxs)("div",{style:{marginTop:"1rem"},children:[s.jsx("button",{type:"button",onClick:j,"aria-label":"Store these notes for use on the Tickets page",children:"Use these notes for Tickets"}),f&&(0,s.jsxs)("span",{style:{marginLeft:"0.75rem",color:"#059669"},children:["Stored."," ",s.jsx(n.default,{href:"/tickets",style:{color:"#2563eb",textDecoration:"underline"},children:"Go to Tickets"})]})]})]})]})}},565:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n,g:()=>s});let s=100,i=["critical","high","medium","low","info"];function n(e){let t,r;let n=e.trim();if(0===n.length)return[null,"Paste JSON (ClustersResponse or clusters array)."];try{t=JSON.parse(n)}catch{return[null,"Invalid JSON. Paste ClustersResponse.clusters or an array of clusters."]}if(Array.isArray(t))r=t;else{if(!(null!==t&&"object"==typeof t&&"clusters"in t&&Array.isArray(t.clusters)))return[null,"Expected a ClustersResponse object (with clusters array) or a raw clusters array."];r=t.clusters}if(r.length>s)return[null,`At most ${s} clusters are allowed.`];let l=[];for(let e=0;e<r.length;e++){var o;let t=r[e];if(null===t||"object"!=typeof t)return[null,`Cluster at index ${e}: must be an object.`];let s="string"==typeof t.vulnerability_id?t.vulnerability_id:void 0,n="string"==typeof t.severity&&(o=t.severity,i.includes(o))?t.severity:void 0,a="string"==typeof t.repo?t.repo:void 0,d="number"==typeof t.cvss_score&&t.cvss_score>=0&&t.cvss_score<=10?t.cvss_score:void 0,c="string"==typeof t.description?t.description:void 0,u=Array.isArray(t.finding_ids)&&t.finding_ids.every(e=>"string"==typeof e)?t.finding_ids:void 0,p="number"==typeof t.affected_services_count&&t.affected_services_count>=0?t.affected_services_count:void 0,g="number"==typeof t.finding_count&&t.finding_count>=0?t.finding_count:void 0;if(void 0===s||void 0===n||void 0===a||void 0===d||void 0===c||void 0===u||void 0===p||void 0===g)return[null,`Cluster at index ${e}: missing or invalid required fields (vulnerability_id, severity, repo, cvss_score, description, finding_ids, affected_services_count, finding_count).`];l.push({vulnerability_id:s,severity:n,repo:a,file_path:"string"==typeof t.file_path?t.file_path:void 0,dependency:"string"==typeof t.dependency?t.dependency:void 0,cvss_score:d,description:c,finding_ids:u,affected_services_count:p,finding_count:g})}return[l,null]}},7277:(e,t,r)=>{"use strict";r.d(t,{ds:()=>i,sg:()=>n});let s="helion_reasoning_response";function i(e){if("undefined"!=typeof sessionStorage)try{let t=JSON.stringify(e);if(t.length>5e5)return;sessionStorage.setItem(s,t)}catch{}}function n(){if("undefined"!=typeof sessionStorage)try{sessionStorage.removeItem(s)}catch{}}},434:(e,t,r)=>{"use strict";r.d(t,{default:()=>i.a});var s=r(9404),i=r.n(s)},2814:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/home/carlos/helion/web/app/reasoning/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[991,636],()=>r(6305));module.exports=s})();