(()=>{var e={};e.id=217,e.ids=[217],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3565:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>c,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>m}),r(2252),r(9935),r(5866);var l=r(3191),i=r(8716),s=r(7922),a=r.n(s),n=r(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let m=["",{children:["exploitability",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2252)),"/home/carlos/helion/web/app/exploitability/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9935)),"/home/carlos/helion/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/carlos/helion/web/app/exploitability/page.tsx"],u="/exploitability/page",c={require:r,loadChunk:()=>Promise.resolve()},p=new l.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/exploitability/page",pathname:"/exploitability",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:m}})},821:(e,t,r)=>{Promise.resolve().then(r.bind(r,1558))},7327:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var l=r(326);let i={marginBottom:"1rem",color:"#b91c1c"};function s({message:e,onRetry:t,retryLabel:r}){return(0,l.jsxs)("div",{role:"alert",style:i,children:[l.jsx("p",{style:{margin:0},children:e}),"function"==typeof t&&l.jsx("button",{type:"button",onClick:t,"aria-label":r??"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},1558:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var l=r(326),i=r(7577),s=r(2809),a=r(7327);function n(){let[e,t]=(0,i.useState)(""),[r,n]=(0,i.useState)(""),[o,m]=(0,i.useState)(""),[d,u]=(0,i.useState)(""),[c,p]=(0,i.useState)(""),[x,b]=(0,i.useState)("idle"),[g,y]=(0,i.useState)(null),[h,j]=(0,i.useState)(null),[v,f]=(0,i.useState)(null),[S,_]=(0,i.useState)("idle"),[C,k]=(0,i.useState)(null),[B,w]=(0,i.useState)(""),P=(0,i.useCallback)(e=>{t((e.target.value??"").slice(0,2e3))},[]),R=(0,i.useCallback)(e=>{n(e.target.value??"")},[]),q=(0,i.useCallback)(e=>{m((e.target.value??"").slice(0,500))},[]),E=(0,i.useCallback)(e=>{u((e.target.value??"").slice(0,100))},[]),L=(0,i.useCallback)(e=>{p((e.target.value??"").slice(0,300))},[]),W=(0,i.useCallback)(async()=>{_("loading"),k(null);try{let e=(0,s.Um)(),t=await e.getClusters();f(t),_("success")}catch(e){k((0,s.e$)(e)),_("error")}},[]),F=(0,i.useCallback)(e=>{w(e.target.value??"")},[]),V=(0,i.useCallback)(()=>{if(!v?.clusters?.length||!B)return;let e=v.clusters.find(e=>e.vulnerability_id===B);e&&(t(e.description.slice(0,2e3)),n(String(e.cvss_score)),m((e.repo??"").slice(0,500)),u((e.dependency??"").slice(0,100)),p(""))},[v,B]),z=(0,i.useCallback)(async t=>{t.preventDefault();let l=e.trim();if(0===l.length){j("Vulnerability summary is required."),b("error");return}let i=Number(r);if(Number.isNaN(i)||i<0||i>10){j("CVSS score must be between 0 and 10."),b("error");return}b("submitting"),y(null),j(null);try{let e=(0,s.Um)(),t=await e.postExploitability({vulnerability_summary:l,cvss_score:i,repo_context:o.trim()||"",dependency_type:d.trim()||"",exposure_flags:c.trim()||""});y(t),b("success")}catch(e){j((0,s.e$)(e)),b("error")}},[e,r,o,d,c]),A=v?.clusters??[],N=A.length>0;return(0,l.jsxs)("main",{style:{padding:"2rem",maxWidth:"36rem",margin:"0 auto"},children:[l.jsx("h1",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Exploitability"}),(0,l.jsxs)("section",{style:{marginBottom:"1.5rem",padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"4px"},"aria-label":"Pre-fill from cluster",children:[l.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Pre-fill from cluster (optional)"}),"loading"===S&&l.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:"Loading clusters…"}),"error"===S&&null!==C&&l.jsx(a.Z,{message:C,onRetry:W,retryLabel:"Retry load clusters"}),"success"===S&&!N&&l.jsx("p",{style:{margin:0},children:"No clusters available. Upload findings first or fill the form manually."}),"success"===S&&N&&(0,l.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem"},children:[l.jsx("label",{htmlFor:"exp-cluster-select",style:{display:"block"},children:"Select a cluster"}),(0,l.jsxs)("select",{id:"exp-cluster-select",value:B,onChange:F,"aria-label":"Select a cluster",disabled:"submitting"===x,style:{minWidth:"16rem",padding:"0.375rem 0.5rem"},children:[l.jsx("option",{value:"",children:"— Select a cluster —"}),A.map(e=>(0,l.jsxs)("option",{value:e.vulnerability_id,children:[e.vulnerability_id," — ",function(e,t){let r=e.trim();return r.length<=60?r:r.slice(0,60)+"…"}(e.description,0)]},e.vulnerability_id))]}),l.jsx("button",{type:"button",onClick:V,disabled:!B||"submitting"===x,"aria-label":"Load selected cluster into form",children:"Load"})]})]}),(0,l.jsxs)("form",{onSubmit:z,children:[(0,l.jsxs)("div",{style:{marginBottom:"1rem"},children:[l.jsx("label",{htmlFor:"exp-summary",style:{display:"block",marginBottom:"0.5rem"},children:"Vulnerability summary (required)"}),l.jsx("textarea",{id:"exp-summary",value:e,onChange:P,maxLength:2e3,rows:3,required:!0,"aria-label":"Vulnerability summary",disabled:"submitting"===x,style:{width:"100%",maxWidth:"28rem",padding:"0.375rem 0.5rem"}})]}),(0,l.jsxs)("div",{style:{marginBottom:"1rem"},children:[l.jsx("label",{htmlFor:"exp-cvss",style:{display:"block",marginBottom:"0.5rem"},children:"CVSS score (0–10, required)"}),l.jsx("input",{id:"exp-cvss",type:"number",min:0,max:10,step:"0.1",value:r,onChange:R,"aria-label":"CVSS score",disabled:"submitting"===x,style:{width:"8rem",padding:"0.375rem 0.5rem"}})]}),(0,l.jsxs)("div",{style:{marginBottom:"1rem"},children:[l.jsx("label",{htmlFor:"exp-repo",style:{display:"block",marginBottom:"0.5rem"},children:"Repo context (optional)"}),l.jsx("input",{id:"exp-repo",type:"text",value:o,onChange:q,maxLength:500,"aria-label":"Repo context",disabled:"submitting"===x,style:{width:"100%",maxWidth:"28rem",padding:"0.375rem 0.5rem"}})]}),(0,l.jsxs)("div",{style:{marginBottom:"1rem"},children:[l.jsx("label",{htmlFor:"exp-dep",style:{display:"block",marginBottom:"0.5rem"},children:"Dependency type (optional)"}),l.jsx("input",{id:"exp-dep",type:"text",value:d,onChange:E,maxLength:100,"aria-label":"Dependency type",disabled:"submitting"===x,style:{width:"100%",maxWidth:"20rem",padding:"0.375rem 0.5rem"}})]}),(0,l.jsxs)("div",{style:{marginBottom:"1rem"},children:[l.jsx("label",{htmlFor:"exp-exposure",style:{display:"block",marginBottom:"0.5rem"},children:"Exposure flags (optional)"}),l.jsx("input",{id:"exp-exposure",type:"text",value:c,onChange:L,maxLength:300,"aria-label":"Exposure flags",disabled:"submitting"===x,style:{width:"100%",maxWidth:"28rem",padding:"0.375rem 0.5rem"}})]}),l.jsx("button",{type:"submit",disabled:"submitting"===x,"aria-busy":"submitting"===x,"aria-label":"submitting"===x?"Running exploitability":"Run exploitability",children:"submitting"===x?"Running…":"Run exploitability"})]}),"error"===x&&null!==h&&""!==h&&l.jsx(a.Z,{message:h}),"success"===x&&null!==g&&(0,l.jsxs)("div",{style:{marginTop:"1.5rem",padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"4px"},children:[l.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Adjusted risk tier"}),l.jsx("p",{style:{marginBottom:"0.75rem"},children:g.adjusted_risk_tier}),l.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Reasoning"}),l.jsx("p",{style:{marginBottom:"0.75rem"},children:g.reasoning}),l.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Recommended action"}),l.jsx("p",{children:g.recommended_action})]})]})}},2252:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});let l=(0,r(8570).createProxy)(String.raw`/home/carlos/helion/web/app/exploitability/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),l=t.X(0,[991,636],()=>r(3565));module.exports=l})();