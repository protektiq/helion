(()=>{var e={};e.id=87,e.ids=[87],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8410:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),t(7182),t(9935),t(5866);var l=t(3191),i=t(8716),s=t(7922),n=t.n(s),a=t(5231),o={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>a[e]);t.d(r,o);let d=["",{children:["results",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7182)),"/home/carlos/helion/web/app/results/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9935)),"/home/carlos/helion/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/carlos/helion/web/app/results/page.tsx"],p="/results/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new l.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/results/page",pathname:"/results",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9126:(e,r,t)=>{Promise.resolve().then(t.bind(t,2323))},7327:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});var l=t(326);let i={marginBottom:"1rem",color:"#b91c1c"};function s({message:e,onRetry:r,retryLabel:t}){return(0,l.jsxs)("div",{role:"alert",style:i,children:[l.jsx("p",{style:{margin:0},children:e}),"function"==typeof r&&l.jsx("button",{type:"button",onClick:r,"aria-label":t??"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},2323:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var l=t(326),i=t(7577),s=t(434),n=t(2809),a=t(7327);let o=["critical","high","medium","low","info"],d=["Tier 1","Tier 2","Tier 3"];function c(e){let r=String(e??"").toLowerCase().trim();return"critical"===r?"Tier 1":"high"===r?"Tier 2":"Tier 3"}function p(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e}function m(){let[e,r]=(0,i.useState)(null),[t,m]=(0,i.useState)("idle"),[u,h]=(0,i.useState)(null),[x,g]=(0,i.useState)("idle"),[y,b]=(0,i.useState)(null),[j,f]=(0,i.useState)(!1),[v,w]=(0,i.useState)({}),[_,C]=(0,i.useState)(""),[S,B]=(0,i.useState)(""),k=(0,i.useCallback)(async()=>{m("loading"),h(null);try{let e=(0,n.Um)(),t=await e.getClusters();r(t),m("success")}catch(e){h((0,n.e$)(e)),m("error")}},[]),A=(0,i.useCallback)(()=>{f(r=>{let t=!r;if(t&&e?.clusters?.length){let r={};for(let t of e.clusters)r[t.vulnerability_id]=c(t.severity);w(r)}return t})},[e?.clusters]),P=(0,i.useCallback)((e,r)=>{("Tier 1"===r||"Tier 2"===r||"Tier 3"===r)&&w(t=>({...t,[e]:r}))},[]),R=(0,i.useCallback)(async()=>{g("exporting"),b(null);let e={use_db:!0,use_reasoning:!1,...j&&Object.keys(v).length>0?{tier_overrides:v}:{}};try{let r=(0,n.Um)(),t=await r.postJiraExport(e),l=Array.isArray(t.errors)?t.errors:[],i=Array.isArray(t.issues)?t.issues.length:0,s=t.epics&&"object"==typeof t.epics?Object.keys(t.epics).length:0,a=`Exported ${i} issue(s) under ${s} epic(s).`;l.length>0&&(a+=" "+l.join(" ")),b(a),g("success")}catch(e){b((0,n.e$)(e)),g("error")}},[j,v]),T=null!==e?function(e){let r={critical:0,high:0,medium:0,low:0,info:0};for(let t of e){let e=String(t.severity??"").toLowerCase().trim();e in r&&(r[e]+=1)}return r}(e.clusters):null,L=(0,i.useMemo)(()=>{if(null===e||!e.clusters.length)return[];let r=e.clusters,t=_.trim().toLowerCase();t&&o.includes(t)&&(r=r.filter(e=>String(e.severity??"").toLowerCase().trim()===t));let l=S.trim().slice(0,200).toLowerCase();return l?r.filter(e=>{let r=String(e.vulnerability_id??"").toLowerCase(),t=String(e.dependency??"").toLowerCase(),i=String(e.repo??"").toLowerCase();return r.includes(l)||t.includes(l)||i.includes(l)}):r},[e,_,S]),E=(0,i.useCallback)(()=>{k()},[k]),I=(0,i.useCallback)(e=>{C(e.target.value)},[]),q=(0,i.useCallback)(e=>{B(e.target.value)},[]);return(0,l.jsxs)("main",{style:{padding:"2rem",maxWidth:"40rem",margin:"0 auto"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[l.jsx("h1",{style:{fontSize:"1.25rem",margin:0},children:"Results summary"}),l.jsx("button",{type:"button",onClick:E,disabled:"loading"===t,"aria-busy":"loading"===t,"aria-label":"loading"===t?"Refreshing":"Refresh clusters and metrics",children:"loading"===t?"Refreshing…":"Refresh"})]}),l.jsx("nav",{style:{marginBottom:"1.5rem"},children:l.jsx(s.default,{href:"/upload",style:{color:"#2563eb",textDecoration:"underline"},"aria-label":"Go to upload page",children:"Upload"})}),"loading"===t&&l.jsx("p",{role:"status","aria-live":"polite",children:"Loading summary…"}),"error"===t&&null!==u&&l.jsx(a.Z,{message:u,onRetry:k,retryLabel:"Retry loading summary"}),"success"===t&&null!==e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"1.5rem"},"aria-label":"Results summary",children:[l.jsx("caption",{style:{textAlign:"left",marginBottom:"0.5rem"},children:"Summary of findings and clusters"}),l.jsx("thead",{children:(0,l.jsxs)("tr",{children:[l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Metric"}),l.jsx("th",{scope:"col",style:{textAlign:"right",padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Count"})]})}),(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Raw findings count"}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:e.metrics.raw_finding_count})]}),(0,l.jsxs)("tr",{children:[l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Cluster count"}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:e.metrics.cluster_count})]}),(0,l.jsxs)("tr",{children:[l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Compression ratio"}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:"number"==typeof e.metrics.compression_ratio?e.metrics.compression_ratio.toFixed(2):e.metrics.compression_ratio})]}),null!==T&&o.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:["Risk tier (",p(e),")"]}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:T[e]})]},e))]})]}),(0,l.jsxs)("section",{style:{marginBottom:"1.5rem"},"aria-label":"Cluster list and filters",children:[l.jsx("h2",{style:{fontSize:"1rem",marginBottom:"0.75rem"},children:"Clusters"}),(0,l.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem 1rem",marginBottom:"0.75rem",alignItems:"center"},children:[(0,l.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[l.jsx("span",{style:{whiteSpace:"nowrap"},children:"Severity"}),(0,l.jsxs)("select",{value:_,onChange:I,"aria-label":"Filter clusters by severity",style:{minWidth:"8rem"},children:[l.jsx("option",{value:"",children:"All"}),o.map(e=>l.jsx("option",{value:e,children:p(e)},e))]})]}),(0,l.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"1 1 12rem",minWidth:0},children:[l.jsx("span",{style:{whiteSpace:"nowrap"},children:"Search"}),l.jsx("input",{type:"search",value:S,onChange:q,placeholder:"vulnerability_id, dependency, repo…","aria-label":"Search clusters by vulnerability ID, dependency, or repo",maxLength:200,style:{flex:1,minWidth:0}})]})]}),l.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"auto",maxHeight:"24rem"},role:"region","aria-label":"Cluster list",children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},"aria-label":"Cluster list: vulnerability ID, severity, repo, dependency, file path, finding count, affected services",children:[l.jsx("thead",{children:(0,l.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:[l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Vulnerability ID"}),l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Severity"}),l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Repo"}),l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Dependency"}),l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"File path"}),l.jsx("th",{scope:"col",style:{textAlign:"right",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Finding count"}),l.jsx("th",{scope:"col",style:{textAlign:"right",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Affected services"})]})}),l.jsx("tbody",{children:0===L.length?l.jsx("tr",{children:l.jsx("td",{colSpan:7,style:{padding:"0.75rem"},children:0===e.clusters.length?"No clusters.":"No clusters match the current filters."})}):L.map(e=>(0,l.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[l.jsx("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},title:e.vulnerability_id,children:e.vulnerability_id}),l.jsx("td",{style:{padding:"0.5rem 0.75rem"},children:p(e.severity)}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},children:e.repo}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},children:e.dependency??"—"}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},children:e.file_path??"—"}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",textAlign:"right"},children:e.finding_count}),l.jsx("td",{style:{padding:"0.5rem 0.75rem",textAlign:"right"},children:e.affected_services_count})]},e.vulnerability_id))})]})})]}),(0,l.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,l.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:j?"0.75rem":0},children:[l.jsx("input",{type:"checkbox",checked:j,onChange:A,"aria-label":"Override tiers before export","aria-checked":j}),l.jsx("span",{children:"Override tiers before export"})]}),j&&e.clusters.length>0&&l.jsx("div",{style:{marginBottom:"1rem",border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"hidden",maxHeight:"16rem",overflowY:"auto"},role:"region","aria-label":"Per-cluster tier override",children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},"aria-label":"Cluster tier overrides",children:[l.jsx("thead",{children:(0,l.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:[l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem"},children:"Cluster"}),l.jsx("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem"},children:"Tier"})]})}),l.jsx("tbody",{children:e.clusters.map(e=>{let r=v[e.vulnerability_id]??c(e.severity),t=e.vulnerability_id.length>48?e.vulnerability_id.slice(0,45)+"...":e.vulnerability_id;return(0,l.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[l.jsx("td",{style:{padding:"0.5rem 0.75rem"},title:e.vulnerability_id,children:t}),l.jsx("td",{style:{padding:"0.5rem 0.75rem"},children:l.jsx("select",{value:r,onChange:r=>P(e.vulnerability_id,r.target.value),"aria-label":`Tier for ${e.vulnerability_id}`,style:{minWidth:"6rem"},children:d.map(e=>l.jsx("option",{value:e,children:e},e))})})]},e.vulnerability_id)})})]})})]}),l.jsx("div",{style:{marginBottom:"1rem"},children:l.jsx("button",{type:"button",onClick:R,disabled:"exporting"===x,"aria-busy":"exporting"===x,"aria-label":"exporting"===x?"Exporting to Jira":"Export to Jira",children:"exporting"===x?"Exporting…":"Export to Jira"})}),(0,l.jsxs)("div",{role:"status","aria-live":"polite",style:{minHeight:"1.5em"},children:["success"===x&&null!==y&&l.jsx("p",{style:{color:"#166534"},children:y}),"error"===x&&null!==y&&""!==y&&l.jsx(a.Z,{message:y})]})]}),"success"===t&&null===e&&l.jsx("p",{role:"status",children:"No summary data."})]})}},434:(e,r,t)=>{"use strict";t.d(r,{default:()=>i.a});var l=t(9404),i=t.n(l)},7182:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});let l=(0,t(8570).createProxy)(String.raw`/home/carlos/helion/web/app/results/page.tsx#default`)}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),l=r.X(0,[991,636],()=>t(8410));module.exports=l})();