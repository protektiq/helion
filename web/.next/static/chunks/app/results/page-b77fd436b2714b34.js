(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87],{6010:function(e,t,r){Promise.resolve().then(r.bind(r,4086))},1627:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var i=r(7437);let n={marginBottom:"1rem",color:"#b91c1c"};function l(e){let{message:t,onRetry:r,retryLabel:l}=e;return(0,i.jsxs)("div",{role:"alert",style:n,children:[(0,i.jsx)("p",{style:{margin:0},children:t}),"function"==typeof r&&(0,i.jsx)("button",{type:"button",onClick:r,"aria-label":null!=l?l:"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},4086:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var i=r(7437),n=r(2265),l=r(7648),o=r(2818),s=r(1627);let a=["critical","high","medium","low","info"],c=["Tier 1","Tier 2","Tier 3"];function d(e){let t=String(null!=e?e:"").toLowerCase().trim();return"critical"===t?"Tier 1":"high"===t?"Tier 2":"Tier 3"}function u(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e}function p(){let[e,t]=(0,n.useState)(null),[r,p]=(0,n.useState)("idle"),[h,m]=(0,n.useState)(null),[y,g]=(0,n.useState)("idle"),[f,x]=(0,n.useState)(null),[b,v]=(0,n.useState)(!1),[j,w]=(0,n.useState)({}),[T,S]=(0,n.useState)(""),[C,k]=(0,n.useState)(""),_=(0,n.useCallback)(async()=>{p("loading"),m(null);try{let e=(0,o.Um)(),r=await e.getClusters();t(r),p("success")}catch(e){m((0,o.e$)(e)),p("error")}},[]);(0,n.useEffect)(()=>{_()},[_]);let B=(0,n.useCallback)(()=>{v(t=>{var r;let i=!t;if(i&&(null==e?void 0:null===(r=e.clusters)||void 0===r?void 0:r.length)){let t={};for(let r of e.clusters)t[r.vulnerability_id]=d(r.severity);w(t)}return i})},[null==e?void 0:e.clusters]),A=(0,n.useCallback)((e,t)=>{("Tier 1"===t||"Tier 2"===t||"Tier 3"===t)&&w(r=>({...r,[e]:t}))},[]),E=(0,n.useCallback)(async()=>{g("exporting"),x(null);let e={use_db:!0,use_reasoning:!1,...b&&Object.keys(j).length>0?{tier_overrides:j}:{}};try{let t=(0,o.Um)(),r=await t.postJiraExport(e),i=Array.isArray(r.errors)?r.errors:[],n=Array.isArray(r.issues)?r.issues.length:0,l=r.epics&&"object"==typeof r.epics?Object.keys(r.epics).length:0,s="Exported ".concat(n," issue(s) under ").concat(l," epic(s).");i.length>0&&(s+=" "+i.join(" ")),x(s),g("success")}catch(e){x((0,o.e$)(e)),g("error")}},[b,j]),L=null!==e?function(e){let t={critical:0,high:0,medium:0,low:0,info:0};for(let i of e){var r;let e=String(null!==(r=i.severity)&&void 0!==r?r:"").toLowerCase().trim();e in t&&(t[e]+=1)}return t}(e.clusters):null,O=(0,n.useMemo)(()=>{if(null===e||!e.clusters.length)return[];let t=e.clusters,r=T.trim().toLowerCase();r&&a.includes(r)&&(t=t.filter(e=>{var t;return String(null!==(t=e.severity)&&void 0!==t?t:"").toLowerCase().trim()===r}));let i=C.trim().slice(0,200).toLowerCase();return i?t.filter(e=>{var t,r,n;let l=String(null!==(t=e.vulnerability_id)&&void 0!==t?t:"").toLowerCase(),o=String(null!==(r=e.dependency)&&void 0!==r?r:"").toLowerCase(),s=String(null!==(n=e.repo)&&void 0!==n?n:"").toLowerCase();return l.includes(i)||o.includes(i)||s.includes(i)}):t},[e,T,C]),R=(0,n.useCallback)(()=>{_()},[_]),I=(0,n.useCallback)(e=>{S(e.target.value)},[]),N=(0,n.useCallback)(e=>{k(e.target.value)},[]);return(0,i.jsxs)("main",{style:{padding:"2rem",maxWidth:"40rem",margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[(0,i.jsx)("h1",{style:{fontSize:"1.25rem",margin:0},children:"Results summary"}),(0,i.jsx)("button",{type:"button",onClick:R,disabled:"loading"===r,"aria-busy":"loading"===r,"aria-label":"loading"===r?"Refreshing":"Refresh clusters and metrics",children:"loading"===r?"Refreshing…":"Refresh"})]}),(0,i.jsx)("nav",{style:{marginBottom:"1.5rem"},children:(0,i.jsx)(l.default,{href:"/upload",style:{color:"#2563eb",textDecoration:"underline"},"aria-label":"Go to upload page",children:"Upload"})}),"loading"===r&&(0,i.jsx)("p",{role:"status","aria-live":"polite",children:"Loading summary…"}),"error"===r&&null!==h&&(0,i.jsx)(s.Z,{message:h,onRetry:_,retryLabel:"Retry loading summary"}),"success"===r&&null!==e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"1.5rem"},"aria-label":"Results summary",children:[(0,i.jsx)("caption",{style:{textAlign:"left",marginBottom:"0.5rem"},children:"Summary of findings and clusters"}),(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Metric"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"right",padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Count"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Raw findings count"}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:e.metrics.raw_finding_count})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Cluster count"}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:e.metrics.cluster_count})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:"Compression ratio"}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:"number"==typeof e.metrics.compression_ratio?e.metrics.compression_ratio.toFixed(2):e.metrics.compression_ratio})]}),null!==L&&a.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb"},children:["Risk tier (",u(e),")"]}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid #e5e7eb",textAlign:"right"},children:L[e]})]},e))]})]}),(0,i.jsxs)("section",{style:{marginBottom:"1.5rem"},"aria-label":"Cluster list and filters",children:[(0,i.jsx)("h2",{style:{fontSize:"1rem",marginBottom:"0.75rem"},children:"Clusters"}),(0,i.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem 1rem",marginBottom:"0.75rem",alignItems:"center"},children:[(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("span",{style:{whiteSpace:"nowrap"},children:"Severity"}),(0,i.jsxs)("select",{value:T,onChange:I,"aria-label":"Filter clusters by severity",style:{minWidth:"8rem"},children:[(0,i.jsx)("option",{value:"",children:"All"}),a.map(e=>(0,i.jsx)("option",{value:e,children:u(e)},e))]})]}),(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"1 1 12rem",minWidth:0},children:[(0,i.jsx)("span",{style:{whiteSpace:"nowrap"},children:"Search"}),(0,i.jsx)("input",{type:"search",value:C,onChange:N,placeholder:"vulnerability_id, dependency, repo…","aria-label":"Search clusters by vulnerability ID, dependency, or repo",maxLength:200,style:{flex:1,minWidth:0}})]})]}),(0,i.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"auto",maxHeight:"24rem"},role:"region","aria-label":"Cluster list",children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},"aria-label":"Cluster list: vulnerability ID, severity, repo, dependency, file path, finding count, affected services",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:[(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Vulnerability ID"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Severity"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Repo"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Dependency"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"File path"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"right",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Finding count"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"right",padding:"0.5rem 0.75rem",whiteSpace:"nowrap"},children:"Affected services"})]})}),(0,i.jsx)("tbody",{children:0===O.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:7,style:{padding:"0.75rem"},children:0===e.clusters.length?"No clusters.":"No clusters match the current filters."})}):O.map(e=>{var t,r;return(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},title:e.vulnerability_id,children:e.vulnerability_id}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem"},children:u(e.severity)}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},children:e.repo}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},children:null!==(t=e.dependency)&&void 0!==t?t:"—"}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",wordBreak:"break-all"},children:null!==(r=e.file_path)&&void 0!==r?r:"—"}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",textAlign:"right"},children:e.finding_count}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem",textAlign:"right"},children:e.affected_services_count})]},e.vulnerability_id)})})]})})]}),(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:b?"0.75rem":0},children:[(0,i.jsx)("input",{type:"checkbox",checked:b,onChange:B,"aria-label":"Override tiers before export","aria-checked":b}),(0,i.jsx)("span",{children:"Override tiers before export"})]}),b&&e.clusters.length>0&&(0,i.jsx)("div",{style:{marginBottom:"1rem",border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"hidden",maxHeight:"16rem",overflowY:"auto"},role:"region","aria-label":"Per-cluster tier override",children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},"aria-label":"Cluster tier overrides",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:[(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem"},children:"Cluster"}),(0,i.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem"},children:"Tier"})]})}),(0,i.jsx)("tbody",{children:e.clusters.map(e=>{var t;let r=null!==(t=j[e.vulnerability_id])&&void 0!==t?t:d(e.severity),n=e.vulnerability_id.length>48?e.vulnerability_id.slice(0,45)+"...":e.vulnerability_id;return(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem"},title:e.vulnerability_id,children:n}),(0,i.jsx)("td",{style:{padding:"0.5rem 0.75rem"},children:(0,i.jsx)("select",{value:r,onChange:t=>A(e.vulnerability_id,t.target.value),"aria-label":"Tier for ".concat(e.vulnerability_id),style:{minWidth:"6rem"},children:c.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})})]},e.vulnerability_id)})})]})})]}),(0,i.jsx)("div",{style:{marginBottom:"1rem"},children:(0,i.jsx)("button",{type:"button",onClick:E,disabled:"exporting"===y,"aria-busy":"exporting"===y,"aria-label":"exporting"===y?"Exporting to Jira":"Export to Jira",children:"exporting"===y?"Exporting…":"Export to Jira"})}),(0,i.jsxs)("div",{role:"status","aria-live":"polite",style:{minHeight:"1.5em"},children:["success"===y&&null!==f&&(0,i.jsx)("p",{style:{color:"#166534"},children:f}),"error"===y&&null!==f&&""!==f&&(0,i.jsx)(s.Z,{message:f})]})]}),"success"===r&&null===e&&(0,i.jsx)("p",{role:"status",children:"No summary data."})]})}},2818:function(e,t,r){"use strict";r.d(t,{Um:function(){return c},e$:function(){return s}});var i=r(6023),n=r(257);let l="http://localhost:8000",o=function(){if("string"!=typeof n.env.NEXT_PUBLIC_API_URL)return l;let e=n.env.NEXT_PUBLIC_API_URL.trim();return e.length>0?e.replace(/\/+$/,""):l};function s(e){return 401===(e&&"object"==typeof e&&"status"in e&&"number"==typeof e.status?e.status:void 0)?"Unauthorized. Please log in.":e instanceof Error?e.message:"Network or request failed."}async function a(e,t,r){var i,n;let l="".concat(e.replace(/\/+$/,"")).concat(t),o=function(e){let t={};return e.token&&e.token.length>0&&(t.Authorization="Bearer ".concat(e.token)),e.contentType&&(t["Content-Type"]=e.contentType),t}({token:r.token,contentType:null!==(i=r.contentType)&&void 0!==i?i:r.body instanceof FormData?void 0:"application/json"}),s={method:r.method,headers:o};void 0!==r.body&&(s.body=r.body);let a=await fetch(l,s);if(!a.ok){let e,t=a.statusText;if((null!==(n=a.headers.get("content-type"))&&void 0!==n?n:"").includes("application/json"))try{let r=await a.json();"detail"in r&&void 0!==r.detail&&(e=r.detail,"string"==typeof r.detail?t=r.detail:Array.isArray(r.detail)&&(t=r.detail.map(e=>e&&"object"==typeof e&&"msg"in e?e.msg:String(e)).join("; ")))}catch(e){}let r=Error(t);throw r.status=a.status,r.detail=e,r}return a.json()}function c(){var e,t;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null!==(e=r.baseUrl)&&void 0!==e?e:o(),l=null!==(t=r.token)&&void 0!==t?t:(0,i.LP)();return{getHealth:()=>a(n,"/api/v1/health/",{method:"GET",token:l}),login:e=>a(n,"/api/v1/auth",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),listUsers:()=>a(n,"/api/v1/auth/users",{method:"GET",token:l}),uploadFindings(e){let t=e instanceof FormData;return a(n,"/api/v1/upload",{method:"POST",token:l,body:t?e:JSON.stringify(e),contentType:t?void 0:"application/json"})},getClusters:()=>a(n,"/api/v1/clusters",{method:"GET",token:l}),postReasoning:e=>a(n,"/api/v1/reasoning",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postExploitability:e=>a(n,"/api/v1/exploitability",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postTickets:e=>a(n,"/api/v1/tickets",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postJiraExport:e=>a(n,"/api/v1/jira/export",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"})}}},6023:function(e,t,r){"use strict";r.d(t,{LP:function(){return n},o4:function(){return l},qz:function(){return o}});let i="helion_access_token";function n(){try{let e=localStorage.getItem(i),t="string"==typeof e?e.trim():"";return t.length>0?t:void 0}catch(e){return}}function l(e){if("string"!=typeof e)return;let t=e.trim();if(0!==t.length)try{let e=t.length>4096?t.slice(0,4096):t;localStorage.setItem(i,e)}catch(e){}}function o(){try{localStorage.removeItem(i)}catch(e){}}},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var i=r(2972),n=r.n(i)},257:function(e,t,r){"use strict";var i,n;e.exports=(null==(i=r.g.process)?void 0:i.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,i,n=e.exports={};function l(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var a=[],c=!1,d=-1;function u(){c&&i&&(c=!1,i.length?a=i.concat(a):d=-1,a.length&&p())}function p(){if(!c){var e=s(u);c=!0;for(var t=a.length;t;){for(i=a,a=[];++d<t;)i&&i[d].run();d=-1,t=a.length}i=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new h(e,t)),1!==a.length||c||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var l=r[e]={exports:{}},o=!0;try{t[e](l,l.exports,i),o=!1}finally{o&&delete r[e]}return l.exports}i.ab="//";var n=i(229);e.exports=n}()}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=6010)}),_N_E=e.O()}]);