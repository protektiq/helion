(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7592:function(t,e,n){Promise.resolve().then(n.bind(n,1117)),Promise.resolve().then(n.bind(n,9758)),Promise.resolve().then(n.t.bind(n,2972,23))},1117:function(t,e,n){"use strict";n.d(e,{default:function(){return a}});var r=n(7437),i=n(2265),o=n(6023);function a(){let[t,e]=(0,i.useState)(""),[n,a]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let t=(0,o.LP)();e("string"==typeof t?t:"")},[]);let s=(0,i.useCallback)(()=>{let e="string"==typeof t?t.trim():"";if(0===e.length)(0,o.qz)();else{let t=e.length>4096?e.slice(0,4096):e;(0,o.o4)(t)}a(!0),setTimeout(()=>a(!1),2e3)},[t]),l=(0,i.useCallback)(t=>{var n;e(null!==(n=t.target.value)&&void 0!==n?n:"")},[]),c=(0,i.useCallback)(t=>{"Enter"===t.key&&(t.preventDefault(),s())},[s]);return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[(0,r.jsx)("label",{htmlFor:"helion-token-input",style:{position:"absolute",width:1,height:1,overflow:"hidden",clip:"rect(0,0,0,0)"},children:"API token (paste JWT for authenticated requests)"}),(0,r.jsx)("input",{id:"helion-token-input",type:"password",value:t,onChange:l,onKeyDown:c,onBlur:s,placeholder:"Paste token","aria-label":"API token (paste JWT for authenticated requests)","aria-describedby":"helion-token-hint",maxLength:4096,style:{minWidth:"8rem",maxWidth:"16rem",padding:"0.25rem 0.5rem",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"4px",background:"#fff",color:"#111"}}),(0,r.jsx)("button",{type:"button",onClick:s,"aria-label":"Save token",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"4px",background:"#f9fafb",color:"#374151",cursor:"pointer"},children:n?"Saved":"Save"}),(0,r.jsx)("span",{id:"helion-token-hint",style:{position:"absolute",width:1,height:1,overflow:"hidden",clip:"rect(0,0,0,0)"},children:"Token is stored in this browser only and sent as Bearer token to the API."})]})}},9758:function(t,e,n){"use strict";n.d(e,{default:function(){return a}});var r=n(7437),i=n(2265),o=n(2818);function a(){let[t,e]=(0,i.useState)("idle"),[n,a]=(0,i.useState)(null),[s,l]=(0,i.useState)(null),c=(0,i.useCallback)(async()=>{e("loading"),l(null),a(null);try{let t=(0,o.Um)(),n=await t.getHealth();a(n),e("success")}catch(t){l((0,o.e$)(t)),e("error")}},[]);(0,i.useEffect)(()=>{c()},[c]);let u={fontSize:"0.75rem",color:"#6b7280",display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0};if("loading"===t)return(0,r.jsxs)("div",{role:"status","aria-live":"polite","aria-label":"Environment and database status loading",style:u,children:[(0,r.jsx)("span",{children:"Env: …"}),(0,r.jsx)("span",{children:"DB: …"})]});if("error"===t)return(0,r.jsxs)("div",{role:"status","aria-live":"polite","aria-label":"Health check failed: ".concat(null!=s?s:"API unreachable"),style:u,children:[(0,r.jsx)("span",{children:"Env: —"}),(0,r.jsx)("span",{children:"DB: —"})]});if("success"===t&&null!==n){var d;let t=function(t){if("string"!=typeof t||0===t.length)return"—";let e=t.trim();return e.length>32?e.slice(0,32):e}(n.environment),e="connected"===(d=n.database)?"connected":"disconnected"===d?"disconnected":"—",i="—"===e?"—":e,o="Environment ".concat(t,", database ").concat(i);return(0,r.jsxs)("div",{role:"status","aria-live":"polite","aria-label":o,style:u,children:[(0,r.jsxs)("span",{children:["Env: ",t]}),(0,r.jsxs)("span",{children:["DB: ",i]})]})}return(0,r.jsxs)("div",{role:"status","aria-live":"polite","aria-label":"Environment and database status unknown",style:u,children:[(0,r.jsx)("span",{children:"Env: —"}),(0,r.jsx)("span",{children:"DB: —"})]})}},2818:function(t,e,n){"use strict";n.d(e,{Um:function(){return c},e$:function(){return s}});var r=n(6023),i=n(257);let o="http://localhost:8000",a=function(){if("string"!=typeof i.env.NEXT_PUBLIC_API_URL)return o;let t=i.env.NEXT_PUBLIC_API_URL.trim();return t.length>0?t.replace(/\/+$/,""):o};function s(t){return 401===(t&&"object"==typeof t&&"status"in t&&"number"==typeof t.status?t.status:void 0)?"Unauthorized. Please log in.":t instanceof Error?t.message:"Network or request failed."}async function l(t,e,n){var r,i;let o="".concat(t.replace(/\/+$/,"")).concat(e),a=function(t){let e={};return t.token&&t.token.length>0&&(e.Authorization="Bearer ".concat(t.token)),t.contentType&&(e["Content-Type"]=t.contentType),e}({token:n.token,contentType:null!==(r=n.contentType)&&void 0!==r?r:n.body instanceof FormData?void 0:"application/json"}),s={method:n.method,headers:a};void 0!==n.body&&(s.body=n.body);let l=await fetch(o,s);if(!l.ok){let t,e=l.statusText;if((null!==(i=l.headers.get("content-type"))&&void 0!==i?i:"").includes("application/json"))try{let n=await l.json();"detail"in n&&void 0!==n.detail&&(t=n.detail,"string"==typeof n.detail?e=n.detail:Array.isArray(n.detail)&&(e=n.detail.map(t=>t&&"object"==typeof t&&"msg"in t?t.msg:String(t)).join("; ")))}catch(t){}let n=Error(e);throw n.status=l.status,n.detail=t,n}return l.json()}function c(){var t,e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=null!==(t=n.baseUrl)&&void 0!==t?t:a(),o=null!==(e=n.token)&&void 0!==e?e:(0,r.LP)();return{getHealth:()=>l(i,"/api/v1/health/",{method:"GET",token:o}),login:t=>l(i,"/api/v1/auth",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),listUsers:()=>l(i,"/api/v1/auth/users",{method:"GET",token:o}),uploadFindings(t){let e=t instanceof FormData;return l(i,"/api/v1/upload",{method:"POST",token:o,body:e?t:JSON.stringify(t),contentType:e?void 0:"application/json"})},getClusters:()=>l(i,"/api/v1/clusters",{method:"GET",token:o}),postReasoning:t=>l(i,"/api/v1/reasoning",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),postExploitability:t=>l(i,"/api/v1/exploitability",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),postTickets:t=>l(i,"/api/v1/tickets",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),postJiraExport:t=>l(i,"/api/v1/jira/export",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"})}}},6023:function(t,e,n){"use strict";n.d(e,{LP:function(){return i},o4:function(){return o},qz:function(){return a}});let r="helion_access_token";function i(){try{let t=localStorage.getItem(r),e="string"==typeof t?t.trim():"";return e.length>0?e:void 0}catch(t){return}}function o(t){if("string"!=typeof t)return;let e=t.trim();if(0!==e.length)try{let t=e.length>4096?e.slice(0,4096):e;localStorage.setItem(r,t)}catch(t){}}function a(){try{localStorage.removeItem(r)}catch(t){}}},257:function(t,e,n){"use strict";var r,i;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(4227)},4227:function(t){!function(){var e={229:function(t){var e,n,r,i=t.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?l=r.concat(l):u=-1,l.length&&p())}function p(){if(!c){var t=s(d);c=!0;for(var e=l.length;e;){for(r=l,l=[];++u<e;)r&&r[u].run();u=-1,e=l.length}r=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function h(){}i.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||c||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}},a=!0;try{e[t](o,o.exports,r),a=!1}finally{a&&delete n[t]}return o.exports}r.ab="//";var i=r(229);t.exports=i}()}},function(t){t.O(0,[972,971,117,744],function(){return t(t.s=7592)}),_N_E=t.O()}]);