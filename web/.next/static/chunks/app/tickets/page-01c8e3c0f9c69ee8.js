(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[988],{9893:function(e,t,n){Promise.resolve().then(n.bind(n,3283))},1627:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(7437);let i={marginBottom:"1rem",color:"#b91c1c"};function l(e){let{message:t,onRetry:n,retryLabel:l}=e;return(0,r.jsxs)("div",{role:"alert",style:i,children:[(0,r.jsx)("p",{style:{margin:0},children:t}),"function"==typeof n&&(0,r.jsx)("button",{type:"button",onClick:n,"aria-label":null!=l?l:"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},3283:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),i=n(2265),l=n(2818),s=n(5934),o=n(9579),a=n(1627);let c=["Tier 1","Tier 2","Tier 3"];function u(){let[e,t]=(0,i.useState)(!0),[n,u]=(0,i.useState)(!1),[d,p]=(0,i.useState)(null),[f,m]=(0,i.useState)(!1),[g,y]=(0,i.useState)("idle"),[h,v]=(0,i.useState)(null),[b,x]=(0,i.useState)(null),[j,_]=(0,i.useState)(null),[S,k]=(0,i.useState)("idle"),[T,C]=(0,i.useState)(""),[w,N]=(0,i.useState)(null),[O,B]=(0,i.useState)(null),[A,E]=(0,i.useState)({}),[J,P]=(0,i.useState)(null),[R,I]=(0,i.useState)(null),U=(0,i.useMemo)(()=>{var t;return e&&(null==j?void 0:null===(t=j.clusters)||void 0===t?void 0:t.length)?j.clusters:!e&&(null==w?void 0:w.length)?w:[]},[e,null==j?void 0:j.clusters,w]);(0,i.useEffect)(()=>{if("undefined"!=typeof sessionStorage)try{let e=sessionStorage.getItem(o.w),t=(0,o.Zf)(e);p(t),m(null!==t)}catch(e){p(null),m(!1)}},[]);let z=(0,i.useCallback)(async()=>{k("loading");try{let e=(0,l.Um)(),t=await e.getClusters();_(t),k("success")}catch(e){k("error")}},[]);(0,i.useEffect)(()=>{e&&z()},[e,z]);let L=(0,i.useCallback)(e=>{t(e.target.checked)},[]),W=(0,i.useCallback)(e=>{u(e.target.checked)},[]),G=(0,i.useCallback)(e=>{m(e.target.checked)},[]),F=(0,i.useCallback)(()=>{(0,o.sg)(),p(null),m(!1)},[]),q=(0,i.useCallback)(e=>{let t=e.target.value;if(C(t),0===t.trim().length){N(null),B(null);return}let[n,r]=(0,s.Y)(t);N(n),B(r)},[]),D=(0,i.useCallback)((e,t)=>{E(n=>{if(""===t||!c.includes(t)){let t={...n};return delete t[e],t}return{...n,[e]:t}})},[]),Z=(0,i.useCallback)(()=>{if(null===J)return;let e=JSON.stringify(J,null,2);navigator.clipboard.writeText(e).then(()=>{I("Copied to clipboard"),setTimeout(()=>I(null),2e3)},()=>I("Copy failed"))},[J]),$=(0,i.useCallback)(async t=>{t.preventDefault();let r=null;if(!e){let e=T.trim();if(0===e.length){B("Paste clusters JSON when not using database.");return}let[t,n]=(0,s.Y)(e);if(null!==n||null===t||0===t.length){B(null!=n?n:"No clusters in pasted JSON.");return}N(t),B(null),r=t}y("submitting"),v(null),x(null);try{let t=f&&null!==d,i={use_db:e,use_reasoning:!t&&n,...t&&d?{reasoning_response:d}:{},...!e&&r&&r.length>0?{clusters:r}:{},...Object.keys(A).length>0?{tier_overrides:A}:{}},s=(0,l.Um)(),o=await s.postTickets(i);P(i),v(o),y("success")}catch(e){x((0,l.e$)(e)),y("error")}},[e,n,f,d,T,A]);return(0,r.jsxs)("main",{style:{padding:"2rem",maxWidth:"56rem",margin:"0 auto"},children:[(0,r.jsx)("h1",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Tickets preview"}),null!==d&&(0,r.jsxs)("div",{style:{marginBottom:"1rem",padding:"0.75rem 1rem",backgroundColor:"#ecfdf5",border:"1px solid #a7f3d0",borderRadius:"4px"},role:"status","aria-live":"polite",children:[(0,r.jsx)("span",{children:"Using reasoning notes from the Reasoning page."}),(0,r.jsx)("button",{type:"button",onClick:F,style:{marginLeft:"0.75rem",padding:"0.25rem 0.5rem",fontSize:"0.875rem"},"aria-label":"Clear stored reasoning notes",children:"Clear stored notes"})]}),(0,r.jsxs)("form",{onSubmit:$,style:{marginBottom:"1.5rem"},children:[(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,r.jsx)("input",{type:"checkbox",checked:e,onChange:L,"aria-label":"Use current clusters from database","aria-checked":e}),(0,r.jsx)("span",{children:"Use current clusters from database"})]}),null!==d?(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,r.jsx)("input",{type:"checkbox",checked:f,onChange:G,"aria-label":"Use stored reasoning notes from Reasoning page","aria-checked":f}),(0,r.jsx)("span",{children:"Use stored reasoning notes"})]}):null,(!d||!f)&&(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[(0,r.jsx)("input",{type:"checkbox",checked:n,onChange:W,"aria-label":"Run reasoning and attach to tickets","aria-checked":n}),(0,r.jsx)("span",{children:"Run reasoning and attach to tickets"})]}),!e&&(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"tickets-paste-clusters",style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Paste clusters JSON"}),(0,r.jsx)("textarea",{id:"tickets-paste-clusters",value:T,onChange:q,placeholder:"Paste ClustersResponse.clusters JSON or full ClustersResponse object",rows:6,style:{width:"100%",padding:"0.5rem 0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #e5e7eb",borderRadius:"4px"},"aria-describedby":O?"tickets-clusters-parse-error":void 0,"aria-invalid":null!==O}),null!==O&&(0,r.jsx)("p",{id:"tickets-clusters-parse-error",role:"alert",style:{marginTop:"0.25rem",color:"#b91c1c",fontSize:"0.875rem"},children:O})]}),U.length>0&&(0,r.jsx)("div",{style:{marginBottom:"1rem"},children:(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #e5e7eb"},"aria-label":"Tier overrides per vulnerability",children:[(0,r.jsx)("caption",{style:{textAlign:"left",marginBottom:"0.5rem",fontWeight:500},children:"Tier overrides (optional)"}),(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,r.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"Vulnerability ID"}),(0,r.jsx)("th",{scope:"col",style:{textAlign:"left",padding:"0.5rem 0.75rem",fontWeight:600},children:"Tier override"})]})}),(0,r.jsx)("tbody",{children:U.map(e=>{var t;return(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,r.jsx)("td",{style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem"},children:e.vulnerability_id}),(0,r.jsx)("td",{style:{padding:"0.5rem 0.75rem"},children:(0,r.jsxs)("select",{value:null!==(t=A[e.vulnerability_id])&&void 0!==t?t:"",onChange:t=>D(e.vulnerability_id,t.target.value),"aria-label":"Tier override for ".concat(e.vulnerability_id),style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem",minWidth:"8rem"},children:[(0,r.jsx)("option",{value:"",children:"No override"}),c.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})})]},e.vulnerability_id)})})]})}),(0,r.jsx)("button",{type:"submit",disabled:"submitting"===g||e&&"loading"===S,"aria-busy":"submitting"===g,"aria-label":"submitting"===g?"Generating tickets":"Generate tickets",children:"submitting"===g?"Loadingâ€¦":"Generate tickets"})]}),"error"===g&&null!==b&&""!==b&&(0,r.jsx)(a.Z,{message:b}),"success"===g&&null!==h&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem",flexWrap:"wrap"},children:[(0,r.jsxs)("h2",{style:{fontSize:"1rem",margin:0},children:["Tickets (",h.tickets.length,")"]}),(0,r.jsx)("button",{type:"button",onClick:Z,disabled:null===J,"aria-label":"Copy request payload as JSON",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},children:"Copy JSON"}),null!==R&&(0,r.jsx)("span",{role:"status","aria-live":"polite",style:{fontSize:"0.875rem",color:"#6b7280"},children:R})]}),(0,r.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:h.tickets.map((e,t)=>(0,r.jsxs)("li",{style:{border:"1px solid #e5e7eb",borderRadius:"4px",padding:"1rem",marginBottom:"1rem"},children:[(0,r.jsx)("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:e.title}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:e.risk_tier_label}),(0,r.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,r.jsx)("strong",{children:"Affected services:"})," ",e.affected_services.join(", ")]}),(0,r.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,r.jsx)("strong",{children:"Recommended remediation:"})," ",e.recommended_remediation]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Acceptance criteria:"}),(0,r.jsx)("ul",{style:{margin:"0.25rem 0 0 1rem",padding:0},children:e.acceptance_criteria.map((e,t)=>(0,r.jsx)("li",{children:e},t))})]}),(0,r.jsx)("div",{style:{marginTop:"0.5rem",whiteSpace:"pre-wrap",fontSize:"0.875rem",color:"#6b7280"},children:e.description})]},t))})]})]})}},2818:function(e,t,n){"use strict";n.d(t,{Um:function(){return c},e$:function(){return o}});var r=n(6023),i=n(257);let l="http://localhost:8000",s=function(){if("string"!=typeof i.env.NEXT_PUBLIC_API_URL)return l;let e=i.env.NEXT_PUBLIC_API_URL.trim();return e.length>0?e.replace(/\/+$/,""):l};function o(e){return 401===(e&&"object"==typeof e&&"status"in e&&"number"==typeof e.status?e.status:void 0)?"Unauthorized. Please log in.":e instanceof Error?e.message:"Network or request failed."}async function a(e,t,n){var r,i;let l="".concat(e.replace(/\/+$/,"")).concat(t),s=function(e){let t={};return e.token&&e.token.length>0&&(t.Authorization="Bearer ".concat(e.token)),e.contentType&&(t["Content-Type"]=e.contentType),t}({token:n.token,contentType:null!==(r=n.contentType)&&void 0!==r?r:n.body instanceof FormData?void 0:"application/json"}),o={method:n.method,headers:s};void 0!==n.body&&(o.body=n.body);let a=await fetch(l,o);if(!a.ok){let e,t=a.statusText;if((null!==(i=a.headers.get("content-type"))&&void 0!==i?i:"").includes("application/json"))try{let n=await a.json();"detail"in n&&void 0!==n.detail&&(e=n.detail,"string"==typeof n.detail?t=n.detail:Array.isArray(n.detail)&&(t=n.detail.map(e=>e&&"object"==typeof e&&"msg"in e?e.msg:String(e)).join("; ")))}catch(e){}let n=Error(t);throw n.status=a.status,n.detail=e,n}return a.json()}function c(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=null!==(e=n.baseUrl)&&void 0!==e?e:s(),l=null!==(t=n.token)&&void 0!==t?t:(0,r.LP)();return{getHealth:()=>a(i,"/api/v1/health/",{method:"GET",token:l}),login:e=>a(i,"/api/v1/auth",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),listUsers:()=>a(i,"/api/v1/auth/users",{method:"GET",token:l}),uploadFindings(e){let t=e instanceof FormData;return a(i,"/api/v1/upload",{method:"POST",token:l,body:t?e:JSON.stringify(e),contentType:t?void 0:"application/json"})},getClusters:()=>a(i,"/api/v1/clusters",{method:"GET",token:l}),postReasoning:e=>a(i,"/api/v1/reasoning",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postExploitability:e=>a(i,"/api/v1/exploitability",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postTickets:e=>a(i,"/api/v1/tickets",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postJiraExport:e=>a(i,"/api/v1/jira/export",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"})}}},6023:function(e,t,n){"use strict";n.d(t,{LP:function(){return i},o4:function(){return l},qz:function(){return s}});let r="helion_access_token";function i(){try{let e=localStorage.getItem(r),t="string"==typeof e?e.trim():"";return t.length>0?t:void 0}catch(e){return}}function l(e){if("string"!=typeof e)return;let t=e.trim();if(0!==t.length)try{let e=t.length>4096?t.slice(0,4096):t;localStorage.setItem(r,e)}catch(e){}}function s(){try{localStorage.removeItem(r)}catch(e){}}},5934:function(e,t,n){"use strict";n.d(t,{Y:function(){return l},g:function(){return r}});let r=100,i=["critical","high","medium","low","info"];function l(e){let t,n;let l=e.trim();if(0===l.length)return[null,"Paste JSON (ClustersResponse or clusters array)."];try{t=JSON.parse(l)}catch(e){return[null,"Invalid JSON. Paste ClustersResponse.clusters or an array of clusters."]}if(Array.isArray(t))n=t;else{if(!(null!==t&&"object"==typeof t&&"clusters"in t&&Array.isArray(t.clusters)))return[null,"Expected a ClustersResponse object (with clusters array) or a raw clusters array."];n=t.clusters}if(n.length>r)return[null,"At most ".concat(r," clusters are allowed.")];let s=[];for(let e=0;e<n.length;e++){var o;let t=n[e];if(null===t||"object"!=typeof t)return[null,"Cluster at index ".concat(e,": must be an object.")];let r="string"==typeof t.vulnerability_id?t.vulnerability_id:void 0,l="string"==typeof t.severity&&(o=t.severity,i.includes(o))?t.severity:void 0,a="string"==typeof t.repo?t.repo:void 0,c="number"==typeof t.cvss_score&&t.cvss_score>=0&&t.cvss_score<=10?t.cvss_score:void 0,u="string"==typeof t.description?t.description:void 0,d=Array.isArray(t.finding_ids)&&t.finding_ids.every(e=>"string"==typeof e)?t.finding_ids:void 0,p="number"==typeof t.affected_services_count&&t.affected_services_count>=0?t.affected_services_count:void 0,f="number"==typeof t.finding_count&&t.finding_count>=0?t.finding_count:void 0;if(void 0===r||void 0===l||void 0===a||void 0===c||void 0===u||void 0===d||void 0===p||void 0===f)return[null,"Cluster at index ".concat(e,": missing or invalid required fields (vulnerability_id, severity, repo, cvss_score, description, finding_ids, affected_services_count, finding_count).")];s.push({vulnerability_id:r,severity:l,repo:a,file_path:"string"==typeof t.file_path?t.file_path:void 0,dependency:"string"==typeof t.dependency?t.dependency:void 0,cvss_score:c,description:u,finding_ids:d,affected_services_count:p,finding_count:f})}return[s,null]}},9579:function(e,t,n){"use strict";n.d(t,{Zf:function(){return i},ds:function(){return l},sg:function(){return s},w:function(){return r}});let r="helion_reasoning_response";function i(e){if(null===e||"string"!=typeof e||0===e.length||e.length>5e5)return null;try{let t=JSON.parse(e);if(null===t||"object"!=typeof t||"string"!=typeof t.summary||!Array.isArray(t.cluster_notes))return null;let n=[];for(let e of t.cluster_notes){if(null===e||"object"!=typeof e||"string"!=typeof e.vulnerability_id||0===e.vulnerability_id.length||"string"!=typeof e.priority||0===e.priority.length||"string"!=typeof e.reasoning)return null;let t=e.assigned_tier;if(null!=t&&![1,2,3].includes(Number(t)))return null;let r=e.override_applied;if(null!=r&&"string"!=typeof r)return null;n.push({vulnerability_id:e.vulnerability_id,priority:e.priority,reasoning:e.reasoning,assigned_tier:null==t?void 0:Number(t),override_applied:null==r?null:r})}return{summary:t.summary,cluster_notes:n}}catch(e){return null}}function l(e){if("undefined"!=typeof sessionStorage)try{let t=JSON.stringify(e);if(t.length>5e5)return;sessionStorage.setItem(r,t)}catch(e){}}function s(){if("undefined"!=typeof sessionStorage)try{sessionStorage.removeItem(r)}catch(e){}}},257:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function l(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var a=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?a=r.concat(a):u=-1,a.length&&p())}function p(){if(!c){var e=o(d);c=!0;for(var t=a.length;t;){for(r=a,a=[];++u<t;)r&&r[u].run();u=-1,t=a.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new f(e,t)),1!==a.length||c||o(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var l=n[e]={exports:{}},s=!0;try{t[e](l,l.exports,r),s=!1}finally{s&&delete n[e]}return l.exports}r.ab="//";var i=r(229);e.exports=i}()}},function(e){e.O(0,[971,117,744],function(){return e(e.s=9893)}),_N_E=e.O()}]);