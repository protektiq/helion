(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[217],{981:function(e,t,n){Promise.resolve().then(n.bind(n,167))},1627:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(7437);let i={marginBottom:"1rem",color:"#b91c1c"};function l(e){let{message:t,onRetry:n,retryLabel:l}=e;return(0,r.jsxs)("div",{role:"alert",style:i,children:[(0,r.jsx)("p",{style:{margin:0},children:t}),"function"==typeof n&&(0,r.jsx)("button",{type:"button",onClick:n,"aria-label":null!=l?l:"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},167:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(7437),i=n(2265),l=n(2818),o=n(1627);function s(){var e;let[t,n]=(0,i.useState)(""),[s,a]=(0,i.useState)(""),[u,c]=(0,i.useState)(""),[d,m]=(0,i.useState)(""),[p,y]=(0,i.useState)(""),[h,g]=(0,i.useState)("idle"),[f,b]=(0,i.useState)(null),[v,x]=(0,i.useState)(null),[j,S]=(0,i.useState)(null),[T,k]=(0,i.useState)("idle"),[C,_]=(0,i.useState)(null),[w,B]=(0,i.useState)(""),E=(0,i.useCallback)(e=>{var t;n((null!==(t=e.target.value)&&void 0!==t?t:"").slice(0,2e3))},[]),L=(0,i.useCallback)(e=>{var t;a(null!==(t=e.target.value)&&void 0!==t?t:"")},[]),N=(0,i.useCallback)(e=>{var t;c((null!==(t=e.target.value)&&void 0!==t?t:"").slice(0,500))},[]),R=(0,i.useCallback)(e=>{var t;m((null!==(t=e.target.value)&&void 0!==t?t:"").slice(0,100))},[]),P=(0,i.useCallback)(e=>{var t;y((null!==(t=e.target.value)&&void 0!==t?t:"").slice(0,300))},[]),O=(0,i.useCallback)(async()=>{k("loading"),_(null);try{let e=(0,l.Um)(),t=await e.getClusters();S(t),k("success")}catch(e){_((0,l.e$)(e)),k("error")}},[]);(0,i.useEffect)(()=>{O()},[O]);let U=(0,i.useCallback)(e=>{var t;B(null!==(t=e.target.value)&&void 0!==t?t:"")},[]),F=(0,i.useCallback)(()=>{var e,t,r;if(!(null==j?void 0:null===(e=j.clusters)||void 0===e?void 0:e.length)||!w)return;let i=j.clusters.find(e=>e.vulnerability_id===w);i&&(n(i.description.slice(0,2e3)),a(String(i.cvss_score)),c((null!==(t=i.repo)&&void 0!==t?t:"").slice(0,500)),m((null!==(r=i.dependency)&&void 0!==r?r:"").slice(0,100)),y(""))},[j,w]),z=(0,i.useCallback)(async e=>{e.preventDefault();let n=t.trim();if(0===n.length){x("Vulnerability summary is required."),g("error");return}let r=Number(s);if(Number.isNaN(r)||r<0||r>10){x("CVSS score must be between ".concat(0," and ").concat(10,".")),g("error");return}g("submitting"),b(null),x(null);try{let e=(0,l.Um)(),t=await e.postExploitability({vulnerability_summary:n,cvss_score:r,repo_context:u.trim()||"",dependency_type:d.trim()||"",exposure_flags:p.trim()||""});b(t),g("success")}catch(e){x((0,l.e$)(e)),g("error")}},[t,s,u,d,p]),A=null!==(e=null==j?void 0:j.clusters)&&void 0!==e?e:[],I=A.length>0;return(0,r.jsxs)("main",{style:{padding:"2rem",maxWidth:"36rem",margin:"0 auto"},children:[(0,r.jsx)("h1",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Exploitability"}),(0,r.jsxs)("section",{style:{marginBottom:"1.5rem",padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"4px"},"aria-label":"Pre-fill from cluster",children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Pre-fill from cluster (optional)"}),"loading"===T&&(0,r.jsx)("p",{style:{margin:"0 0 0.5rem 0"},children:"Loading clusters…"}),"error"===T&&null!==C&&(0,r.jsx)(o.Z,{message:C,onRetry:O,retryLabel:"Retry load clusters"}),"success"===T&&!I&&(0,r.jsx)("p",{style:{margin:0},children:"No clusters available. Upload findings first or fill the form manually."}),"success"===T&&I&&(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("label",{htmlFor:"exp-cluster-select",style:{display:"block"},children:"Select a cluster"}),(0,r.jsxs)("select",{id:"exp-cluster-select",value:w,onChange:U,"aria-label":"Select a cluster",disabled:"submitting"===h,style:{minWidth:"16rem",padding:"0.375rem 0.5rem"},children:[(0,r.jsx)("option",{value:"",children:"— Select a cluster —"}),A.map(e=>(0,r.jsxs)("option",{value:e.vulnerability_id,children:[e.vulnerability_id," — ",function(e,t){let n=e.trim();return n.length<=60?n:n.slice(0,60)+"…"}(e.description,0)]},e.vulnerability_id))]}),(0,r.jsx)("button",{type:"button",onClick:F,disabled:!w||"submitting"===h,"aria-label":"Load selected cluster into form",children:"Load"})]})]}),(0,r.jsxs)("form",{onSubmit:z,children:[(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"exp-summary",style:{display:"block",marginBottom:"0.5rem"},children:"Vulnerability summary (required)"}),(0,r.jsx)("textarea",{id:"exp-summary",value:t,onChange:E,maxLength:2e3,rows:3,required:!0,"aria-label":"Vulnerability summary",disabled:"submitting"===h,style:{width:"100%",maxWidth:"28rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"exp-cvss",style:{display:"block",marginBottom:"0.5rem"},children:"CVSS score (0–10, required)"}),(0,r.jsx)("input",{id:"exp-cvss",type:"number",min:0,max:10,step:"0.1",value:s,onChange:L,"aria-label":"CVSS score",disabled:"submitting"===h,style:{width:"8rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"exp-repo",style:{display:"block",marginBottom:"0.5rem"},children:"Repo context (optional)"}),(0,r.jsx)("input",{id:"exp-repo",type:"text",value:u,onChange:N,maxLength:500,"aria-label":"Repo context",disabled:"submitting"===h,style:{width:"100%",maxWidth:"28rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"exp-dep",style:{display:"block",marginBottom:"0.5rem"},children:"Dependency type (optional)"}),(0,r.jsx)("input",{id:"exp-dep",type:"text",value:d,onChange:R,maxLength:100,"aria-label":"Dependency type",disabled:"submitting"===h,style:{width:"100%",maxWidth:"20rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"exp-exposure",style:{display:"block",marginBottom:"0.5rem"},children:"Exposure flags (optional)"}),(0,r.jsx)("input",{id:"exp-exposure",type:"text",value:p,onChange:P,maxLength:300,"aria-label":"Exposure flags",disabled:"submitting"===h,style:{width:"100%",maxWidth:"28rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsx)("button",{type:"submit",disabled:"submitting"===h,"aria-busy":"submitting"===h,"aria-label":"submitting"===h?"Running exploitability":"Run exploitability",children:"submitting"===h?"Running…":"Run exploitability"})]}),"error"===h&&null!==v&&""!==v&&(0,r.jsx)(o.Z,{message:v}),"success"===h&&null!==f&&(0,r.jsxs)("div",{style:{marginTop:"1.5rem",padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"4px"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Adjusted risk tier"}),(0,r.jsx)("p",{style:{marginBottom:"0.75rem"},children:f.adjusted_risk_tier}),(0,r.jsx)("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Reasoning"}),(0,r.jsx)("p",{style:{marginBottom:"0.75rem"},children:f.reasoning}),(0,r.jsx)("h2",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"Recommended action"}),(0,r.jsx)("p",{children:f.recommended_action})]})]})}},2818:function(e,t,n){"use strict";n.d(t,{Um:function(){return u},e$:function(){return s}});var r=n(6023),i=n(257);let l="http://localhost:8000",o=function(){if("string"!=typeof i.env.NEXT_PUBLIC_API_URL)return l;let e=i.env.NEXT_PUBLIC_API_URL.trim();return e.length>0?e.replace(/\/+$/,""):l};function s(e){return 401===(e&&"object"==typeof e&&"status"in e&&"number"==typeof e.status?e.status:void 0)?"Unauthorized. Please log in.":e instanceof Error?e.message:"Network or request failed."}async function a(e,t,n){var r,i;let l="".concat(e.replace(/\/+$/,"")).concat(t),o=function(e){let t={};return e.token&&e.token.length>0&&(t.Authorization="Bearer ".concat(e.token)),e.contentType&&(t["Content-Type"]=e.contentType),t}({token:n.token,contentType:null!==(r=n.contentType)&&void 0!==r?r:n.body instanceof FormData?void 0:"application/json"}),s={method:n.method,headers:o};void 0!==n.body&&(s.body=n.body);let a=await fetch(l,s);if(!a.ok){let e,t=a.statusText;if((null!==(i=a.headers.get("content-type"))&&void 0!==i?i:"").includes("application/json"))try{let n=await a.json();"detail"in n&&void 0!==n.detail&&(e=n.detail,"string"==typeof n.detail?t=n.detail:Array.isArray(n.detail)&&(t=n.detail.map(e=>e&&"object"==typeof e&&"msg"in e?e.msg:String(e)).join("; ")))}catch(e){}let n=Error(t);throw n.status=a.status,n.detail=e,n}return a.json()}function u(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=null!==(e=n.baseUrl)&&void 0!==e?e:o(),l=null!==(t=n.token)&&void 0!==t?t:(0,r.LP)();return{getHealth:()=>a(i,"/api/v1/health/",{method:"GET",token:l}),login:e=>a(i,"/api/v1/auth",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),listUsers:()=>a(i,"/api/v1/auth/users",{method:"GET",token:l}),uploadFindings(e){let t=e instanceof FormData;return a(i,"/api/v1/upload",{method:"POST",token:l,body:t?e:JSON.stringify(e),contentType:t?void 0:"application/json"})},getClusters:()=>a(i,"/api/v1/clusters",{method:"GET",token:l}),postReasoning:e=>a(i,"/api/v1/reasoning",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postExploitability:e=>a(i,"/api/v1/exploitability",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postTickets:e=>a(i,"/api/v1/tickets",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"}),postJiraExport:e=>a(i,"/api/v1/jira/export",{method:"POST",token:l,body:JSON.stringify(e),contentType:"application/json"})}}},6023:function(e,t,n){"use strict";n.d(t,{LP:function(){return i},o4:function(){return l},qz:function(){return o}});let r="helion_access_token";function i(){try{let e=localStorage.getItem(r),t="string"==typeof e?e.trim():"";return t.length>0?t:void 0}catch(e){return}}function l(e){if("string"!=typeof e)return;let t=e.trim();if(0!==t.length)try{let e=t.length>4096?t.slice(0,4096):t;localStorage.setItem(r,e)}catch(e){}}function o(){try{localStorage.removeItem(r)}catch(e){}}},257:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function l(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a=[],u=!1,c=-1;function d(){u&&r&&(u=!1,r.length?a=r.concat(a):c=-1,a.length&&m())}function m(){if(!u){var e=s(d);u=!0;for(var t=a.length;t;){for(r=a,a=[];++c<t;)r&&r[c].run();c=-1,t=a.length}r=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new p(e,t)),1!==a.length||u||s(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var l=n[e]={exports:{}},o=!0;try{t[e](l,l.exports,r),o=!1}finally{o&&delete n[e]}return l.exports}r.ab="//";var i=r(229);e.exports=i}()}},function(e){e.O(0,[971,117,744],function(){return e(e.s=981)}),_N_E=e.O()}]);