(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{5654:function(t,e,n){Promise.resolve().then(n.bind(n,1056))},1627:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(7437);let i={marginBottom:"1rem",color:"#b91c1c"};function o(t){let{message:e,onRetry:n,retryLabel:o}=t;return(0,r.jsxs)("div",{role:"alert",style:i,children:[(0,r.jsx)("p",{style:{margin:0},children:e}),"function"==typeof n&&(0,r.jsx)("button",{type:"button",onClick:n,"aria-label":null!=o?o:"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},1056:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return s}});var r=n(7437),i=n(2265),o=n(7648),l=n(2818),a=n(1627);function s(){let[t,e]=(0,i.useState)(null),[n,s]=(0,i.useState)("idle"),[u,c]=(0,i.useState)(null),[d,p]=(0,i.useState)(null),[f,h]=(0,i.useState)(null),m=(0,i.useCallback)(t=>{var n,r;e(null!==(r=null===(n=t.target.files)||void 0===n?void 0:n[0])&&void 0!==r?r:null),s("idle"),c(null),p(null),h(null)},[]),y=(0,i.useCallback)(async e=>{if(e.preventDefault(),!t)return;if(!t.name.toLowerCase().endsWith(".json")){s("error"),p("File must have a .json extension.");return}let n=new FormData;n.append("file",t),s("uploading"),c(null),p(null),h(null);try{let t=(0,l.Um)(),e=await t.uploadFindings(n);c(e),s("success")}catch(t){Array.isArray(null==t?void 0:t.detail)&&t.detail.length>0?(h(t.detail),p(null)):(h(null),p((0,l.e$)(t))),s("error")}},[t]),g=!t||"uploading"===n;return(0,r.jsxs)("main",{style:{padding:"2rem",maxWidth:"32rem",margin:"0 auto"},children:[(0,r.jsx)("h1",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Upload findings (JSON)"}),(0,r.jsxs)("form",{onSubmit:y,children:[(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"file-input",style:{display:"block",marginBottom:"0.5rem"},children:"File"}),(0,r.jsx)("input",{id:"file-input",type:"file",accept:".json",onChange:m,"aria-label":"Select JSON file"})]}),(0,r.jsx)("button",{type:"submit",disabled:g,"aria-busy":"uploading"===n,"aria-label":"uploading"===n?"Uploading":"Submit",children:"Submit"})]}),"error"===n&&null!==f&&f.length>0&&(0,r.jsxs)("div",{role:"alert",style:{marginTop:"1rem",marginBottom:"1rem",color:"#b91c1c"},children:[(0,r.jsx)("p",{style:{margin:"0 0 0.5rem 0"},children:"Validation errors:"}),(0,r.jsx)("ul",{style:{margin:0,paddingLeft:"1.25rem"},children:f.map((t,e)=>{var n;return(0,r.jsxs)("li",{style:{marginBottom:"0.25rem"},children:[(null===(n=t.loc)||void 0===n?void 0:n.length)?"".concat(t.loc.join(" → "),": "):"",t.msg]},e)})})]}),"error"===n&&null!==d&&""!==d&&null===f&&(0,r.jsx)(a.Z,{message:d}),(0,r.jsxs)("div",{role:"status","aria-live":"polite",style:{marginTop:"1rem",minHeight:"1.5em"},children:["idle"===n&&(0,r.jsx)("p",{style:{color:"#666"},children:"Select a JSON file and submit."}),"uploading"===n&&(0,r.jsx)("p",{children:"Uploading…"}),"success"===n&&null!==u&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:["Done. Accepted: ",u.accepted,u.ids&&u.ids.length>0?". IDs: ".concat(u.ids.length):""]}),(0,r.jsx)("p",{style:{marginTop:"0.5rem"},children:(0,r.jsx)(o.default,{href:"/results",style:{color:"#2563eb",textDecoration:"underline"},"aria-label":"View results",children:"View results"})})]})]})]})}},2818:function(t,e,n){"use strict";n.d(e,{Um:function(){return u},e$:function(){return a}});var r=n(6023),i=n(257);let o="http://localhost:8000",l=function(){if("string"!=typeof i.env.NEXT_PUBLIC_API_URL)return o;let t=i.env.NEXT_PUBLIC_API_URL.trim();return t.length>0?t.replace(/\/+$/,""):o};function a(t){return 401===(t&&"object"==typeof t&&"status"in t&&"number"==typeof t.status?t.status:void 0)?"Unauthorized. Please log in.":t instanceof Error?t.message:"Network or request failed."}async function s(t,e,n){var r,i;let o="".concat(t.replace(/\/+$/,"")).concat(e),l=function(t){let e={};return t.token&&t.token.length>0&&(e.Authorization="Bearer ".concat(t.token)),t.contentType&&(e["Content-Type"]=t.contentType),e}({token:n.token,contentType:null!==(r=n.contentType)&&void 0!==r?r:n.body instanceof FormData?void 0:"application/json"}),a={method:n.method,headers:l};void 0!==n.body&&(a.body=n.body);let s=await fetch(o,a);if(!s.ok){let t,e=s.statusText;if((null!==(i=s.headers.get("content-type"))&&void 0!==i?i:"").includes("application/json"))try{let n=await s.json();"detail"in n&&void 0!==n.detail&&(t=n.detail,"string"==typeof n.detail?e=n.detail:Array.isArray(n.detail)&&(e=n.detail.map(t=>t&&"object"==typeof t&&"msg"in t?t.msg:String(t)).join("; ")))}catch(t){}let n=Error(e);throw n.status=s.status,n.detail=t,n}return s.json()}function u(){var t,e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=null!==(t=n.baseUrl)&&void 0!==t?t:l(),o=null!==(e=n.token)&&void 0!==e?e:(0,r.LP)();return{getHealth:()=>s(i,"/api/v1/health/",{method:"GET",token:o}),login:t=>s(i,"/api/v1/auth",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),listUsers:()=>s(i,"/api/v1/auth/users",{method:"GET",token:o}),uploadFindings(t){let e=t instanceof FormData;return s(i,"/api/v1/upload",{method:"POST",token:o,body:e?t:JSON.stringify(t),contentType:e?void 0:"application/json"})},getClusters:()=>s(i,"/api/v1/clusters",{method:"GET",token:o}),postReasoning:t=>s(i,"/api/v1/reasoning",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),postExploitability:t=>s(i,"/api/v1/exploitability",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),postTickets:t=>s(i,"/api/v1/tickets",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"}),postJiraExport:t=>s(i,"/api/v1/jira/export",{method:"POST",token:o,body:JSON.stringify(t),contentType:"application/json"})}}},6023:function(t,e,n){"use strict";n.d(e,{LP:function(){return i},o4:function(){return o},qz:function(){return l}});let r="helion_access_token";function i(){try{let t=localStorage.getItem(r),e="string"==typeof t?t.trim():"";return e.length>0?e:void 0}catch(t){return}}function o(t){if("string"!=typeof t)return;let e=t.trim();if(0!==e.length)try{let t=e.length>4096?e.slice(0,4096):e;localStorage.setItem(r,t)}catch(t){}}function l(){try{localStorage.removeItem(r)}catch(t){}}},7648:function(t,e,n){"use strict";n.d(e,{default:function(){return i.a}});var r=n(2972),i=n.n(r)},257:function(t,e,n){"use strict";var r,i;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(4227)},4227:function(t){!function(){var e={229:function(t){var e,n,r,i=t.exports={};function o(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(t){n=l}}();var s=[],u=!1,c=-1;function d(){u&&r&&(u=!1,r.length?s=r.concat(s):c=-1,s.length&&p())}function p(){if(!u){var t=a(d);u=!0;for(var e=s.length;e;){for(r=s,s=[];++c<e;)r&&r[c].run();c=-1,e=s.length}r=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function h(){}i.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new f(t,e)),1!==s.length||u||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}},l=!0;try{e[t](o,o.exports,r),l=!1}finally{l&&delete n[t]}return o.exports}r.ab="//";var i=r(229);t.exports=i}()}},function(t){t.O(0,[972,971,117,744],function(){return t(t.s=5654)}),_N_E=t.O()}]);