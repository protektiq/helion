(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3017:function(t,e,n){Promise.resolve().then(n.bind(n,6776))},1627:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(7437);let o={marginBottom:"1rem",color:"#b91c1c"};function i(t){let{message:e,onRetry:n,retryLabel:i}=t;return(0,r.jsxs)("div",{role:"alert",style:o,children:[(0,r.jsx)("p",{style:{margin:0},children:e}),"function"==typeof n&&(0,r.jsx)("button",{type:"button",onClick:n,"aria-label":null!=i?i:"Retry",style:{marginTop:"0.5rem"},children:"Retry"})]})}},6776:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return u}});var r=n(7437),o=n(2265),i=n(5475),a=n(6023),s=n(2818),l=n(1627);function u(){let t=(0,i.useRouter)(),[e,n]=(0,o.useState)(""),[u,c]=(0,o.useState)(""),[d,m]=(0,o.useState)("idle"),[p,f]=(0,o.useState)(null),h=(0,o.useCallback)(t=>{var e;n((null!==(e=t.target.value)&&void 0!==e?e:"").slice(0,255))},[]),g=(0,o.useCallback)(t=>{var e;c(null!==(e=t.target.value)&&void 0!==e?e:"")},[]),y=(0,o.useCallback)(async n=>{n.preventDefault();let r=e.trim();if(0===r.length){f("Username is required."),m("error");return}if(u.length<8){f("Password must be at least ".concat(8," characters.")),m("error");return}if(u.length>128){f("Password must be at most ".concat(128," characters.")),m("error");return}m("submitting"),f(null);try{let e=(0,s.Um)(),n=await e.login({username:r,password:u});(0,a.o4)(n.access_token),m("success"),t.push("/")}catch(t){f((0,s.e$)(t)),m("error")}},[e,u,t]);return(0,r.jsxs)("main",{style:{padding:"2rem",maxWidth:"28rem",margin:"0 auto"},children:[(0,r.jsx)("h1",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Login"}),(0,r.jsxs)("form",{onSubmit:y,children:[(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"login-username",style:{display:"block",marginBottom:"0.5rem"},children:"Username"}),(0,r.jsx)("input",{id:"login-username",type:"text",value:e,onChange:h,maxLength:255,autoComplete:"username","aria-label":"Username",disabled:"submitting"===d,style:{width:"100%",maxWidth:"20rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{htmlFor:"login-password",style:{display:"block",marginBottom:"0.5rem"},children:"Password"}),(0,r.jsx)("input",{id:"login-password",type:"password",value:u,onChange:g,minLength:8,maxLength:128,autoComplete:"current-password","aria-label":"Password",disabled:"submitting"===d,style:{width:"100%",maxWidth:"20rem",padding:"0.375rem 0.5rem"}})]}),(0,r.jsx)("button",{type:"submit",disabled:"submitting"===d,"aria-busy":"submitting"===d,"aria-label":"submitting"===d?"Logging in":"Log in",children:"submitting"===d?"Logging inâ€¦":"Log in"})]}),"error"===d&&null!==p&&""!==p&&(0,r.jsx)(l.Z,{message:p}),(0,r.jsx)("p",{"aria-live":"polite",style:{marginTop:"1rem",fontSize:"0.875rem",color:"#6b7280"},children:"The token is stored locally in this browser only."})]})}},2818:function(t,e,n){"use strict";n.d(e,{Um:function(){return u},e$:function(){return s}});var r=n(6023),o=n(257);let i="http://localhost:8000",a=function(){if("string"!=typeof o.env.NEXT_PUBLIC_API_URL)return i;let t=o.env.NEXT_PUBLIC_API_URL.trim();return t.length>0?t.replace(/\/+$/,""):i};function s(t){return 401===(t&&"object"==typeof t&&"status"in t&&"number"==typeof t.status?t.status:void 0)?"Unauthorized. Please log in.":t instanceof Error?t.message:"Network or request failed."}async function l(t,e,n){var r,o;let i="".concat(t.replace(/\/+$/,"")).concat(e),a=function(t){let e={};return t.token&&t.token.length>0&&(e.Authorization="Bearer ".concat(t.token)),t.contentType&&(e["Content-Type"]=t.contentType),e}({token:n.token,contentType:null!==(r=n.contentType)&&void 0!==r?r:n.body instanceof FormData?void 0:"application/json"}),s={method:n.method,headers:a};void 0!==n.body&&(s.body=n.body);let l=await fetch(i,s);if(!l.ok){let t,e=l.statusText;if((null!==(o=l.headers.get("content-type"))&&void 0!==o?o:"").includes("application/json"))try{let n=await l.json();"detail"in n&&void 0!==n.detail&&(t=n.detail,"string"==typeof n.detail?e=n.detail:Array.isArray(n.detail)&&(e=n.detail.map(t=>t&&"object"==typeof t&&"msg"in t?t.msg:String(t)).join("; ")))}catch(t){}let n=Error(e);throw n.status=l.status,n.detail=t,n}return l.json()}function u(){var t,e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=null!==(t=n.baseUrl)&&void 0!==t?t:a(),i=null!==(e=n.token)&&void 0!==e?e:(0,r.LP)();return{getHealth:()=>l(o,"/api/v1/health/",{method:"GET",token:i}),login:t=>l(o,"/api/v1/auth",{method:"POST",token:i,body:JSON.stringify(t),contentType:"application/json"}),listUsers:()=>l(o,"/api/v1/auth/users",{method:"GET",token:i}),uploadFindings(t){let e=t instanceof FormData;return l(o,"/api/v1/upload",{method:"POST",token:i,body:e?t:JSON.stringify(t),contentType:e?void 0:"application/json"})},getClusters:()=>l(o,"/api/v1/clusters",{method:"GET",token:i}),postReasoning:t=>l(o,"/api/v1/reasoning",{method:"POST",token:i,body:JSON.stringify(t),contentType:"application/json"}),postExploitability:t=>l(o,"/api/v1/exploitability",{method:"POST",token:i,body:JSON.stringify(t),contentType:"application/json"}),postTickets:t=>l(o,"/api/v1/tickets",{method:"POST",token:i,body:JSON.stringify(t),contentType:"application/json"}),postJiraExport:t=>l(o,"/api/v1/jira/export",{method:"POST",token:i,body:JSON.stringify(t),contentType:"application/json"})}}},6023:function(t,e,n){"use strict";n.d(e,{LP:function(){return o},o4:function(){return i},qz:function(){return a}});let r="helion_access_token";function o(){try{let t=localStorage.getItem(r),e="string"==typeof t?t.trim():"";return e.length>0?e:void 0}catch(t){return}}function i(t){if("string"!=typeof t)return;let e=t.trim();if(0!==e.length)try{let t=e.length>4096?e.slice(0,4096):e;localStorage.setItem(r,t)}catch(t){}}function a(){try{localStorage.removeItem(r)}catch(t){}}},257:function(t,e,n){"use strict";var r,o;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(4227)},4227:function(t){!function(){var e={229:function(t){var e,n,r,o=t.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l=[],u=!1,c=-1;function d(){u&&r&&(u=!1,r.length?l=r.concat(l):c=-1,l.length&&m())}function m(){if(!u){var t=s(d);u=!0;for(var e=l.length;e;){for(r=l,l=[];++c<e;)r&&r[c].run();c=-1,e=l.length}r=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function f(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||u||s(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}},a=!0;try{e[t](i,i.exports,r),a=!1}finally{a&&delete n[t]}return i.exports}r.ab="//";var o=r(229);t.exports=o}()}},function(t){t.O(0,[971,117,744],function(){return t(t.s=3017)}),_N_E=t.O()}]);